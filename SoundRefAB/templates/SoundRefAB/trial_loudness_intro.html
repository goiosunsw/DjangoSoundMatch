{% extends 'SoundRefAB/base.html' %}

{% load staticfiles %}
<link rel="stylesheet" type="text/css" href="{% static 'SoundRefAB/style.css' %}">


{% load staticfiles %}

{% block head_block %}
    <script type="text/javascript">
       function validateFormOnSubmit(theForm){
           if (getConfidenceVal() == "") {
               alert("Please rate before submitting!");
               return false;
           }
           
           var x = document.getElementsByClassName("played");
           var i;
           for (i = 0; i < x.length; i++) {
               if (! x[i].value) {
                   alert("Please listen to all sounds before submitting!");
                   return false;
               };
           }
           
           return true;
       }
   
   
    </script>

{% endblock %}

<h1>Sound level adjust</h1>

<p>In the next few experiments we will ask you to listen to a first tone</p>
    <table border="1px" margin="10px">
        <tr>
            <td>
                <h2>Reference</h2>
                <input class="played" type="hidden" id="played_ref" value="">
                <audio id="audio0" src='{% static 'SoundRefAB/pg_loudness_adj_ref.wav' %}'>
                    Your browser does not support the audio element.
                </audio>
                <script type="text/javascript">
                   function Play0(){
                      var v = document.getElementById("audio0");
                      v.play();
                      document.getElementById("played_ref").value="1";
                   }
                </script>
            <input type="button" onclick="Play0();"  value="Play"/>
            </td>
        </tr>
    </table>


<p>And then, with a slider adjust a second tone so that it sounds <b>twice as loud</b> as the first sound.</p>

<p>For example, the next sound is considered by most people to be about twice as loud as the one above:</p>

    <table border="1px" margin="10px">
        <tr>
            <td>
                <h2>Reference</h2>
                <input class="played" type="hidden" id="played_sam1" value="">
                <audio id="audio1" src='{% static 'SoundRefAB/pg_loudness_adj_refX2.wav' %}'>
                    Your browser does not support the audio element.
                </audio>
                <script type="text/javascript">
                   function Play1(){
                      var v = document.getElementById("audio1");
                      v.play();
                      document.getElementById("played_sam1").value="1";
                   }
                </script>
            <input type="button" onclick="Play1();"  value="Play"/>
            </td>
        </tr>
    </table>

<div style="height:10px;clear:both;"></div>
<!--  
<form action="{% url 'srefab:next' subject_id %}"  method="post" id="next_page">
     <input type="button" style="font-size:24;width:100px;height:50px" type="submit" name="submit"  value="Next"/>
</form>
-->

<!-- FIXME: this should become a questionnaire and data sent into the db-->
<form action="{% url 'srefab:next' subject_id %}" onsubmit="return validateFormOnSubmit(this)" method="post" id="LoudnessForm">
    <input type="hidden" id="valid" value="0">
    
    <table border="1px" margin="10px">
        <tr>
            <td>
                <p>How confident are you about judging sounds "twice as loud"?</p>
                {% include 'SoundRefAB/confidence_radio.html' %}
            </td>
            <td>
                <p>Leave a comment about your understanding of brightness:</p>
                <textarea rows="4" cols="50" name="comment"></textarea>
            </td>
        </tr>
    </table>
    <div style="height:20px"></div>
    <div style="height:10px;clear:both;"></div>

    <input style="font-size:24;width:100px;height:50px" type="submit" name="submit" value="Next" />
</form>

{% endblock %}
